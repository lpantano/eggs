```{r setup, echo=FALSE}
library(knitr)
opts_chunk$set(tidy=TRUE, highlight=T, figalign="center",
 fig.height=6, fig.width=6, message=F, error=F, warning=F)
```


```{r load}
data<-read.table("stats_isomirs", header=T)
```


Correct isomir annotation for miraligner.

```{r iso}
library(ggplot2)
library(reshape)
data_gg <- melt(data,id.vars = "name")
ggplot(data_gg, aes(variable, fill = value)) +
    geom_bar() +
    scale_fill_brewer(palette = "Set1")
    theme_bw()
```

The majority are correct, but there are some errors are addition and 3' trimming 
annotation. It makes sense because it could be an addition that match the 
reference by chance, but the tool will determine as trimming and no addition.
How size affects the alignments
```{r dev='svg'}
ggplot(data,aes(V8,V7,fill=V3))+
  geom_boxplot()+
  theme_bw()+ labs(x="")+
  scale_fill_brewer("mapped",palette="Set1")
```

How changes affect the alignment
```{r dev='svg',fig.width=9}
ggplot(data,aes(V8,fill=changes))+
  geom_bar()+
  theme_bw()+ labs(x="")+
  facet_wrap(~V3)+
  scale_fill_brewer("changes",palette="Set1")
```


How many were assigned to only the correct miRNA. Normally miRNA can map to other miRNAs that are from the same family. "Red" will be sequences mapping to multiple miRNAs.
```{r dev='svg'}
ggplot(data[data$V3=="yes",],aes(V8,fill=factor(TP)))+
  geom_bar()+
  theme_bw()+ labs(x="")+
  scale_fill_brewer("correct",palette="Set1")
```


# isomirs

```{r load-iso}
stat_iso <- read.table("isomirs_stats.tsv")
```

```{r uniquely}
uniquely = subset(stat_iso, V8 == 1)
multi = subset(stat_iso, V8 > 1)
```

Number of sequences with multihits `r length(unique(multi[,1]))` and 
uniquelye mapped `r nrow(uniquely)`.

```{r correct}
uniquely$dif5 <- uniquely$V6 - uniquely$V4
```
